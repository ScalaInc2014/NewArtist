{"filter":false,"title":"strategy.js","tooltip":"/Authentication/Manual/Signin/strategy.js","undoManager":{"stack":[[{"start":{"row":0,"column":0},"end":{"row":52,"column":33},"action":"insert","lines":["var LocalStrategy   = require('passport-local').Strategy;","var models = require('../../../Models');"," ","/**","  <p> Returns a function with  the UserStrategy in relation with the User's Type: </p>","","    <ul>","        <li> Populates userModel in relation with the UserType.","        <li> Declare a Strategy that starts the processes to signin through userModel.signinPromise .","        <li> The Signin Promise returns the Authentication's result and passes it to Passport's Done() Method.","    </ul>"," * @param {string} userType - Fan || Artists."," * @memberof module:Authentication"," * @inner"," * @return {function} Passport Strategy","*/","","var getUserStrategy = function (userType) {","    ","    var userModel = models[userType];    ","    ","    var userStrategy = new LocalStrategy(","    ","        { ","            usernameField: 'email',","            ","        },","    ","        function(email, password, done) {","    ","            userModel.manualSignin(email, password)","                ","                .then(function(result){","","                    if(result.user)","                        return done(null,result.user);","                    else{","                        return done(null, false, { message: result.informationMessage });","                    }","                })","                ","                .then(null,function(err){","                    ","                    return done(err);","                });","        }","    );","        ","    return userStrategy;","};","","","module.exports = getUserStrategy;"],"id":1}]],"mark":0,"position":0},"ace":{"folds":[],"scrolltop":0,"scrollleft":0,"selection":{"start":{"row":52,"column":33},"end":{"row":52,"column":33},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":0},"timestamp":1432310128711,"hash":"b8dc24ddca2c4bdb1525bce6083c9bc54a4705f0"}